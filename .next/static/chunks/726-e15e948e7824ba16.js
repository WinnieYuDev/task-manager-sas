"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[726],{67396:(e,t,n)=>{n.d(t,{default:()=>l.a});var r=n(44839),l=n.n(r)},76046:(e,t,n)=>{var r=n(66658);n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}})},73838:(e,t,n)=>{n.d(t,{B:()=>i,h:()=>u});var r=n(95155),l=n(74359),o=n(20841),a=n(12115);function i(){return(0,a.useContext)(s)}function u(e){var t;let{client:n,storage:o,storageNamespace:a,replaceURL:i,children:u}=e;return(0,r.jsx)(w,{client:n,storage:null!=o?o:"undefined"==typeof window?void 0:null===(t=window)||void 0===t?void 0:t.localStorage,storageNamespace:null!=a?a:n.address,replaceURL:null!=i?i:e=>{window.history.replaceState({},"",e)},children:(0,r.jsx)(l.N2,{client:n,useAuth:h,children:u})})}let s=(0,a.createContext)(void 0),c=(0,a.createContext)(void 0),d="__convexAuthOAuthVerifier",f="__convexAuthJWT",v="__convexAuthRefreshToken";function w(e){var t;let{client:n,storage:l,storageNamespace:i,replaceURL:u,children:w}=e,h=(0,a.useRef)(null),[k,m]=(0,a.useState)(!0),[b,C]=(0,a.useState)(!1),S=null===(t=n.options)||void 0===t?void 0:t.verbose,_=(0,a.useCallback)(e=>{S&&console.debug("".concat(new Date().toISOString()," ").concat(e))},[S]),{storageSet:x,storageGet:R,storageRemove:E,storageKey:j}=function(e,t){let n=t.replace(/[^a-zA-Z0-9]/g,""),r=(0,a.useCallback)(e=>"".concat(e,"_").concat(n),[t]);return{storageSet:(0,a.useCallback)((t,n)=>e.setItem(r(t),n),[e,r]),storageGet:(0,a.useCallback)(t=>e.getItem(r(t)),[e,r]),storageRemove:(0,a.useCallback)(t=>e.removeItem(r(t)),[e,r]),storageKey:r}}(l,i),A=(0,a.useCallback)(async e=>{if(null===e.tokens)h.current=null,e.shouldStore&&(await E(f),await E(v)),C(!1);else{let{token:t}=e.tokens;if(h.current=t,e.shouldStore){let{refreshToken:n}=e.tokens;await x(f,t),await x(v,n)}C(!0)}m(!1)},[x,E]);(0,a.useEffect)(()=>{let e=e=>{(async()=>{if(e.storageArea===l&&e.key===j(f)){let t=e.newValue;_("synced access token, is null: ".concat(null===t)),await A({shouldStore:!1,tokens:null===t?null:{token:t}})}})()};return g("storage",e),()=>y("storage",e)},[A]);let I=(0,a.useCallback)(async e=>{let{tokens:t}=await new o.Tb(n.address).action("auth:signIn","code"in e?{params:{code:e.code},verifier:e.verifier}:e);return _("retrieved tokens, is null: ".concat(null===t)),await A({shouldStore:!0,tokens:null!=t?t:null}),null!==t},[n,A]),P=(0,a.useCallback)(async(e,t)=>{var r;let l=t instanceof FormData?Array.from(t.entries()).reduce((e,t)=>{let[n,r]=t;return e[n]=r,e},{}):null!=t?t:{},o=null!==(r=await R(d))&&void 0!==r?r:void 0;await E(d);let a=await n.action("auth:signIn",{provider:e,params:l,verifier:o});if(void 0!==a.redirect){let e=new URL(a.redirect);return await x(d,a.verifier),void 0!==window.location&&(window.location.href=e.toString()),{signingIn:!1,redirect:e}}if(void 0!==a.tokens){let{tokens:e}=a;return _("signed in and got tokens, is null: ".concat(null===e)),await A({shouldStore:!0,tokens:e}),{signingIn:null!==a.tokens}}return{signingIn:!1}},[n,A,R]),N=(0,a.useCallback)(async()=>{n.action("auth:signOut"),_("signed out, erasing tokens"),await A({shouldStore:!0,tokens:null})},[A,n]),O=(0,a.useCallback)(async e=>{let{forceRefreshToken:t}=e;if(t){let e=h.current;return await p(v,async()=>{var t;let n=h.current;if(n!==e)return _("returning synced token, is null: ".concat(null===n)),n;let r=null!==(t=await R(v))&&void 0!==t?t:null;if(null===r)return _("returning null, there is no refresh token"),null;{await E(v);let e=e=>{e.preventDefault(),e.returnValue=!0};return g("beforeunload",e),await I({refreshToken:r}),y("beforeunload",e),_("returning retrieved token, is null: ".concat(null===n)),h.current}})}return h.current},[I,N,R]),V=(0,a.useRef)(!1);return(0,a.useEffect)(()=>{var e;if(null==l)throw Error("`localStorage` is not available in this environment, set the `storage` prop on `ConvexAuthProvider`!");let t=void 0!==(null===(e=window)||void 0===e?void 0:e.location)?new URLSearchParams(window.location.search).get("code"):null;if(V.current||t){if(t){V.current=!0;let e=new URL(window.location.href);e.searchParams.delete("code"),(async()=>{await u(e.pathname+e.search+e.hash),await P(void 0,{code:t}),V.current=!1})()}}else(async()=>{var e;let t=null!==(e=await R(f))&&void 0!==e?e:null;_("retrieved token from storage, is null: ".concat(null===t)),await A({shouldStore:!1,tokens:null===t?null:{token:t}})})()},[n,A,P,R]),(0,r.jsx)(c.Provider,{value:{isLoading:k,isAuthenticated:b,fetchAccessToken:O},children:(0,r.jsx)(s.Provider,{value:{signIn:P,signOut:N},children:w})})}function h(){let{isLoading:e,isAuthenticated:t,fetchAccessToken:n}=(0,a.useContext)(c);return(0,a.useMemo)(()=>({isLoading:e,isAuthenticated:t,fetchAccessToken:n}),[n,e,t])}async function p(e,t){var n,r;let l=null===(r=window)||void 0===r?void 0:null===(n=r.navigator)||void 0===n?void 0:n.locks;return void 0!==l?await l.request(e,t):await t()}function g(e,t,n){var r,l;null===(r=(l=window).addEventListener)||void 0===r||r.call(l,e,t,n)}function y(e,t,n){var r,l;null===(r=(l=window).removeEventListener)||void 0===r||r.call(l,e,t,n)}},88068:(e,t,n)=>{n.d(t,{s:()=>a,t:()=>o});var r=n(12115);function l(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function o(...e){return t=>{let n=!1,r=e.map(e=>{let r=l(e,t);return n||"function"!=typeof r||(n=!0),r});if(n)return()=>{for(let t=0;t<r.length;t++){let n=r[t];"function"==typeof n?n():l(e[t],null)}}}}function a(...e){return r.useCallback(o(...e),e)}},12317:(e,t,n)=>{n.d(t,{DX:()=>c});var r,l=n(12115),o=n(88068),a=n(95155),i=Symbol.for("react.lazy"),u=(r||(r=n.t(l,2)))[" use ".trim().toString()];function s(e){var t;return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===i&&"_payload"in e&&"object"==typeof(t=e._payload)&&null!==t&&"then"in t}var c=function(e){let t=function(e){let t=l.forwardRef((e,t)=>{let{children:n,...r}=e;if(s(n)&&"function"==typeof u&&(n=u(n._payload)),l.isValidElement(n)){var a;let e,i;let u=(a=n,(e=Object.getOwnPropertyDescriptor(a.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?a.ref:(e=Object.getOwnPropertyDescriptor(a,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?a.props.ref:a.props.ref||a.ref),s=function(e,t){let n={...t};for(let r in t){let l=e[r],o=t[r];/^on[A-Z]/.test(r)?l&&o?n[r]=(...e)=>{let t=o(...e);return l(...e),t}:l&&(n[r]=l):"style"===r?n[r]={...l,...o}:"className"===r&&(n[r]=[l,o].filter(Boolean).join(" "))}return{...e,...n}}(r,n.props);return n.type!==l.Fragment&&(s.ref=t?(0,o.t)(t,u):u),l.cloneElement(n,s)}return l.Children.count(n)>1?l.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),n=l.forwardRef((e,n)=>{let{children:r,...o}=e;s(r)&&"function"==typeof u&&(r=u(r._payload));let i=l.Children.toArray(r),c=i.find(f);if(c){let e=c.props.children,r=i.map(t=>t!==c?t:l.Children.count(e)>1?l.Children.only(null):l.isValidElement(e)?e.props.children:null);return(0,a.jsx)(t,{...o,ref:n,children:l.isValidElement(e)?l.cloneElement(e,void 0,r):null})}return(0,a.jsx)(t,{...o,ref:n,children:r})});return n.displayName=`${e}.Slot`,n}("Slot"),d=Symbol("radix.slottable");function f(e){return l.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===d}}}]);